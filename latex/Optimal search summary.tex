\documentclass[a4paper]{article}
\usepackage[english]{babel}
%\usepackage[utf8x]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}\usepackage{graphicx}
\usepackage{multicol}
\usepackage{float}
\usepackage{textcomp}
\usepackage{gensymb}
\usepackage{listings}
\usepackage{color}
\usepackage[margin=1cm]{caption}
\usepackage[margin=1in]{geometry}
\usepackage{fancyhdr}

\title{Debris-Informed Underwater Search and Rescue Optimized in Two Parts}
\author{}
\date{}

\newcommand*{\Scale}[2][4]{\scalebox{#1}{$#2$}}
\pagestyle{fancy}
\fancyhf{}
\lhead{Team 40670}
\rhead{Page \thepage\, of ***}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\definecolor{black}{rgb}{0,0,0}

\renewcommand\thesection{\arabic{section}}
\renewcommand\thesubsection{\thesection.\arabic{subsection}}
\renewcommand\thesubsubsection{\thesubsection.\arabic{subsubsection}}

%\setlength\parindent{0em}
%\setlength{\parskip}{5pt}
%\renewcommand{\theenumi}{\Alph{enumi}}
\begin{document}\maketitle

\begin{abstract}
A model for optimal discrete-effort search and rescue for a plane in in water is presented. The search is split into two parts: the first is an aerial search for debris, and the second is an underwater search for the remainder of the plane body. Both of these are generalized with respect to the search technology used. A current model (not included in this paper) is used to generate probability distributions for debris and the plane body in the search area. This transformation allows debris data to aid the search for a lost plane. Searches in the water are then optimized based on the likelihood of discovery versus the cost of search. Both the likelihood of discovery and cost may be changed on a per-technology basis, allowing for the simultaneous use of any number of different search technologies. Results of test runs demonstrate a logarithmic relationship between percent success, number of search vehicles, and number of searches. A direct linear relationship was found between cost of searching, number of search vehicles, and number of searches. The model does not function optimally when cost is factored in. Computation time is linear with respect to iterations and number of ships. 
\end{abstract}

\pagebreak 

\section{Introduction}

The model is partitioned into two separate searches. First, a visual aerial search is performed for floating debris. Locations and times of discovery of debris are indexed. 

An existing model for the oceanic currents of the region is presumed to already exist. This model is then applied to convert positional data of debris into a probable area of the plane crash.  This positional prediction data is combined with data from the ocean current model in order to create a more localized search area of the wreckage on the sea floor. A second underwater search, informed by the aerial search, is then conducted via underwater vehicles utilizing sonar. The underwater search maximizes search effectiveness while minimizing cost and distance of searching. 

\section{General Discrete-effort Optimal Searching}

The discrete-effort method of Lawrence Stone's \textit{Theory of Optimal Search} is used in both searches to prioritize and distribute search efforts. An overview of this method is provided here. 

\subsection{Defining the Terms Used in Searching}

The search space $\mathcal{J}$ is divided into an integer number of uniformly square cells $j\in\mathcal{J}$. The specific technologies (i.e. one type of Autonomous Underwater Vehicle versus another) used in the search are indexed for convenience by integers in $\mathcal{T}$. This allows for implementation of different measurement accuracies and cost functions as search technology advances, or simply as different technology is chosen. 

For each search technology $t\in\mathcal{T}$ used, each cell $j\in\mathcal{J}$ is associated with a cost of searching. This cost is expressed in terms of the cell number and the number of times searched: $\gamma_t(j,k)$. This represents the cost of the $k$th search in cell $j$ using technology $t$.

It is important to note that $\gamma_t(j,k)$ can be defined with respect to a general cost function, $c_t(j,k)$; by contrast, $c_t$ is the cost of searching  a \textit{total} of $k$ discrete times. Ergo, $$\gamma_t(j,k_n)=c_t(j,k_n)-c_t(j,k_{n-1})$$

The probability of debris existing in a given cell is denoted by $p(j)$.

Finally, $\beta_t(j,k)$ is the probability of locating an object in cell $j$ using tech $t$ on the $k$th attempt, assuming that the object is actually in cell $j$.

The quantity $p(j)\beta(j,k)$ represents the actual chance of finding debris in the $j$th cell on the $k^{th}$ search. $\beta$ assumes the object is in the current cell being searched, where the product $\beta * p$ does not assume so.

Next, the optimization problem is stated. The optimal individual cell to focus the search methods on is the one which provides the highest chance of success per unit search cost. This value, denoted as $\epsilon$, is defined as $$\epsilon_t\equiv\epsilon_t(j,k)=\frac{p(j)\beta_t(j,k)}{\gamma_t(j,k)}$$. 

An $\epsilon$ can be computed for each cell, accounting for the number of searches $k$ for each one. The highest values are the ones with the greatest probability of success per unit cost. 

\subsection{Assigning Values to $\beta_t(j,k)$}

Suppose $\alpha_t$ is the success rate for locating an object, whether underwater or aerial, with $t\in\mathcal{T}$. Then, from \textit{Theory of Optimal Search}: \[\beta_t(j,k)=\alpha_t\cdot(1-\alpha_t)^{k-1}\]

This representation follows that each successive search has an exponentially decreasing chance of success. The derivation is not copied here. It is worth noting, however, that the $\alpha_t$ value will significantly depend on the technology used and the context within the model is applied.

\subsection{Cost Functions as Prioritization}

The cost $\gamma_t(j,k)$ provides flexibility for the model in terms of prioritization. Considerations such as distance, time, and money may be confounding variables in the cost of searching. The resulting function $\gamma$ will depend entirely on the technology being used. In this model, the cost of searching a cell is assumed to be equal to the distance traveled to reach the cell. In this way, distance, travel time, and monetary cost are roughly minimized.

In this model, the distance parameter in the cost of the function, such that $\gamma_t(j,k)=d_{travel}$, where $d_{travel}$ is the Euclidean distance in cells from the current position to the position under consideration. This has the benefit of moving ships around as little as possible. One may extend the cost function by including the time to search - in other words, $\gamma(j,k)=t_{search}+d_{travel}$. The inclusion of travel time implies specifying the technology to be used, however; as a result, this method of prioritization is not included here.  

\subsection{Evolving Probability Distributions over Failed Searches}

In the event that the model does not find an object in cell $k$, the probability distribution must be modified to accommodate for the altered search area. Let $T$ represent the probability that the plane is in the cell, and $F$ the probability that it is found. Then: 
$$P(T|F)=\frac{P(T)P(F|T)}{P(F)}$$ 
$$P(T|\sim F)=\frac{p(j)[1-\beta_t(j,k)]}{(p(j)[1-\beta_t(j,k)]+(1-p(j))}$$

By reduction, the posterior probability that the object is there but was not found is: $$p'(j)=p(j)\frac{1-\beta_t(j,k)}{1-\beta_t(j,k)p(j)},\;\mbox{where }j\mbox{ is searched}$$.

The posterior probability of every other square can be similarly adjusted by the knowledge that an object was not discovered in cell $k$ (though its proof is omitted): $$p'(j)=p(j)\frac{1}{1-p(j)\beta_t(j,k)},\;\mbox{where }j\mbox{ is not searched.}$$

After the application of these transformations, as $p'$ is a probability distribution, the quantity $$\sum_{j\in\mathcal{J}}p'(j) = 1$$

(The notation here may be confusing. For clarification, the first $p'(j)$ adjustment applies only to the square that was searched; the second applies to every other square.)

After a failed search, the probability of the plane being in cell $j$ becomes this probability.

\subsection{Executing the Search Method}

Suppose there is a set $\mathcal{T}$ of search technologies and $n_t$ instances of technology $t\in\mathcal{T}$. For each device, the $\epsilon$ value is computed. Optimizing this value returns the highest probability of object discovery per unit cost.

Each device is allocated sequentially to a square that is a) not already being searched, and b) has the highest $\epsilon$ value for that technology. Should two devices conflict in their optimal square, the closest device of that type claims it. Though travel time is not modeled, it is reasonable to make preliminary decisions in deference to it.

Whenever a device finishes searching, the probability distribution of the object's position is recomputed according to the above transformation, the device's $\epsilon$ value is recomputed based on the new distribution, and it is assigned to a new cell.

The net success is the cumulative product of $p_t(j)*\beta_t(j,k)$. Suppose $f_t(j)$ is the total number of searches allocated to cell $j$. Then, the net probability that the plane has been discovered by a single technology can thus be expressed as: $$\sum p_t(j)\beta_t(j,f_t(j))$$

\input{assumptions_file.tex}

\section{Current Flow Modeling and Aerial Search}

Existing ocean current models are sufficient for determining approximately where a discovered piece of debris could have come from. These current models are not included in this paper, although their outputs significant. and are declared as follows:

A current model is assumed to generate two probability distributions: the first is the distribution of debris, and the second is the positional distribution of the plane. The debris distribution is $p_d(j)$ (for $j\in\mathcal{J}$). The plane's positional distribution is considered naive at the outset, as it is not yet informed by the position of debris. The naive positional distribution is $p_n(j)$. 

Additionally, it is expected that the current model be able to adjust the positional probability of the plane based on the originating point of the debris. This is expressed with the operator $\mathtt{T}$. This will be defined later. 

The first step in this model for object search is to perform an aerial debris search. 

Planes will search through cells in a manner specified by the general optimal search model. The highest discovery rate to cost ratio will be investigated first, then each other cell sequentially.

The presence of debris at cell $j$ is $d_j\in \{0,1\}$. It is assumed that there either is or is not debris in a cell. If debris is present, then $\mathtt{T}$ modifies the probability distribution $p_n$ in order to represent the likelihood that debris came from a plane crash. This is expressed as: $$\mathtt{T}(d_j,p_n)=p_n'$$

Repeated application of $\mathtt{T}$ over each cell $d_j$ will create the new positional distribution informed by debris, $p_w$. This is created by: $$p_w=\mathtt{T}(d_1, \mathtt{T}(d_2, \ldots \mathtt{T}(d_j, p_n)\ldots))$$

\section{Underwater Plane Body Search}
The second step in the model is performing the underwater search. 

Autonomous underwater vehicles will follow the general search method previously stated in section 3.5. The cost function $\gamma_t(j,k)$ is slightly altered. A distance cost is added: $\gamma_t(j,k)=d$, where $d$ is the distance that would be traversed by each vessel in moving from its current location to a new target cell $k$. This cost function seeks to minimize $d$ as to overall maximize the probability of successfully locating the vessel. Analysis of the effectiveness of this function is presented in the next section.

\section{Model Analysis}

A Monte Carlo simulation was run over 15,000 iterations on three parameters of the model, and three inputs were gathered, as listed in figure 1. It was additionally assumed that only one technology is used for the duration of the search. Extension into multiple technologies is fully possible, but was not done during this Monte Carlo simulation in order to isolate the general search dynamics.

\begin{figure}[H]\begin{center}\begin{tabular}{|c|c|c|c|}
\hline \textbf{Parameter} & \textbf{Description} & \textbf{Minimum} & \textbf{Maximum}\\\hline\hline
$\alpha$ & Probability of success of one search & 0.2 & 0.5 \\\hline
$i$ & Number of search iterations performed & 10 & 750 \\\hline
$n$ & Number of ships used in search & 1 & 25 \\\hline\hline
\textbf{Output} & \textbf{Description} &&\\\hline
$DT$ & Total distance traveled by all ships &&\\\hline
$PD$ & Probability that the search has discovered the object &&\\\hline
$NS$ & Total number of searched cells &&\\\hline
$CT$ & Computation time for model (in ms) &&\\\hline
\end{tabular}\end{center}
\caption{Table of parameters and collected outputs.}
\end{figure}

In order to fully observe the dynamics of the search, all cell searches are assumed to have failed. This is simply a consequence of the fact that if the search had succeeded, it would have stopped. The goal is to observe dynamics.

The probability distribution used for input was intentionally designed to have several local maxima at varying heights. The probability distribution used is also continuous everywhere, though is not continuous past the first search iteration. The surface used is represented by $$|\mbox{peaks(70)}|\div \sum_j |\text{peaks(70)}|$$

\begin{figure}[H]\begin{center}
\includegraphics[scale=0.5]{../Matlab/Images/InitialProbDist.png}
\includegraphics[scale=0.5]{../Matlab/Images/InitialProbDistSurf.png}
\caption{Probability distribution used in Monte Carlo simulation}
\end{center}\end{figure}

It is worth noting that a grid resolution of 70 was chosen. As computation time increases with the square of grid size, a sufficiently low value was chosen for computation which simultaneously allowed for sufficiently high resolution. 

Additionally, the model is invariant under cell size. Each search iteration is not represented in the time used to search a cell, so the total work done in searching a cell is ``one unit.'' The conversion from the single unit work to time changes based on cell size, but is not modeled.

Initial allocation was then performed on the ships in this distribution. This placed the $n$ ships in the grid according to the highest $\epsilon$ values. The probability distribution is then evolved assuming failure of search. 

\begin{figure}[H]\begin{center}
\includegraphics[scale=0.35]{../Matlab/Images/ModelSearch001.png}
\includegraphics[scale=0.35]{../Matlab/Images/ModelSearch020.png}
\includegraphics[scale=0.35]{../Matlab/Images/ModelSearch100.png}
\caption{Prob. dist. of 15 ships after 1, 20, and 100 search iterations respectively.}
\end{center}\end{figure}

As can be seen, the probability of the object's presence in unsearched squares increases, and the probability in searched squares decreases. 

The technology is considered to be functionally uniform. As is noted in section 2.2, the effectiveness of searching a square drops with the number of times the square has been searched. This is intuitively correct; because the square has been searched before, it is less likely to be successfully searched on the second iteration. As a consequence, $\beta$ decreases with search count. This can be seen in figure 4.

\begin{figure}[H]\begin{center}
\includegraphics[scale=0.5]{../Matlab/Images/After100SearchCount.png}
\includegraphics[scale=0.5]{../Matlab/Images/After100SearchEffectiveness.png}
\caption{Search count and $\beta$ values after 100 iterations with 15 ships.}
\end{center}\end{figure}

\subsection{Cost function analysis}

The cost function as written above may appear arbitrary. To some extent, it is. However, it is effective at serving its purpose: to minimize the distance traveled by the ships with respect to the effectiveness of the overall search. In order to determine whether this cost functions serves its purpose well, two functions were compared. The first, $\gamma_{t1}(j,k)=1$, disregards distance traveled. The second, $\gamma_{t2}(j,k)=d_{\mbox{traveled}}$ uses the distance as a cost. What follows is an evolution of the two cost functions.

\begin{figure}[H]\begin{center}
\includegraphics[scale=0.45]{../Matlab/Images/SearchCountNoDist010.png}
\includegraphics[scale=0.45]{../Matlab/Images/SearchCountDist010.png}
\caption{Evolution comparison at 10 iterations}
\end{center}\end{figure}

After 10 iterations, the difference between $\gamma=1$ and $\gamma=d$ is apparent. In $\gamma=1$, ships have appeared and have searched in the lower portion of the search space. However, in $\gamma=d$, ships have remained near the first local maximum, frequently searching twice rather than moving somewhere else.

\begin{figure}[H]\begin{center}
\includegraphics[scale=0.45]{../Matlab/Images/SearchCountNoDist050.png}
\includegraphics[scale=0.45]{../Matlab/Images/SearchCountDist050.png}
\caption{Evolution comparison at 50 iterations}
\end{center}\end{figure}

After 50 iterations, $\gamma=1$ has evolved to the point where the lower maximum has been searched twice. This is the lowest search iteration (rounded to the nearest 10) for which this is true. By comparison, the $\gamma=d$ search regime has searched the upper maximum and surrounding area extensively, but has not moved from there. The next notable point occurs at 230 iterations.

\begin{figure}[H]\begin{center}
\includegraphics[scale=0.45]{../Matlab/Images/SearchCountNoDist230.png}
\includegraphics[scale=0.45]{../Matlab/Images/SearchCountDist230.png}
\caption{Evolution comparison at 230 iterations}
\end{center}\end{figure}

At 230 iterations, the $\gamma=d$ search regime has begun to scan the lower maximum. This is in contrast to the $\gamma=1$ regime, which has scanned the lower maximum significantly more thoroughly.

The progression of the $\gamma=1$ regime matches the local maxima of the base probability in figure 2. Because $\gamma=1$, the value of $\epsilon$ merely follows: $$\epsilon = p(j)*\beta(j,k)$$

Search vessels simply move to the places where the probability of discovering something is highest. This, naturally, roughly follows the original distribution map.

\subsection{Effect of the $\gamma=d$ search regime}

The $\gamma=d$ search regime does not leave its localized area until approximately five times later than the $\gamma=1$ regime. This is potentially unwanted behavior. 

However, this is not the complete picture. To understand the significant role the cost function plays in the optimization process, one must look at the total distance traveled by ships:

\begin{figure}[H]\begin{center}
\begin{tabular}{|c|c|c|}
\hline & $DT$ & $PD$\\\hline\hline
$\gamma=1$ & 144902 & $45.7\%$\\\hline
$\gamma=d$ & 3809 & $43.8\%$\\\hline
\end{tabular}
\caption{DT: Distance Traveled (cells); PD: Probability of Discovery}
\end{center}\end{figure}

The difference here is profound. Without optimizing for distance, the distance the ships travel is $\approx 38$ times that of $\gamma=d$. The gain in effectiveness is only $1.9\%$. Therefore, by sacrificing roughly two percent of our distance movement, we gain a 38-fold reduction in distance traveled.

\subsection{Sensitivity analysis of $PD$}

One of the most critical components of the model is the probability that the search has discovered the object. It is important to understand how this probability varies with the model inputs. In order to evaluate this, the data from the Monte Carlo simulation was passed through a logarithmic fit.

\begin{figure}[H]\begin{center}
\includegraphics[scale=0.5]{../Matlab/Images/LogSearchIterPctSuccessMSE0.png}
\includegraphics[scale=0.5]{../Matlab/Images/LogShipCtPctSuccessMSE0.png}
\caption{Log fit lines in blue; Search iter fit line: $-0.4809+0.3304*log_{10}(x)$; Ship iter fit line: $-0.0142+0.3433*log_{10}(x)$}
\end{center}\end{figure}

Two notes about these graphs: first, the number of ships is a discrete quantity between 1 and 25. The number of search iterations is discrete as well, though fine enough to appear continuous. Second, the mean squared error on both graphs is $< 0.02$.

It is clear that the percent success provides diminishing returns as iteration count increases, and as number of ships increases. The limiting factor here is the $\beta$ function - as the total number of searches goes up, the returns decrease on the whole.

Combined, these two form the primary distribution indicating the success of the search:

\begin{figure}[H]\begin{center}
\includegraphics[scale=0.75]{../Matlab/Images/PctSuccessByItersShips.png}
\caption{Histogram of the probability of success. Vertical noise is partially a result of interpolation and partially a result of $\alpha$ distributions.}
\end{center}\end{figure}

This histogram suggests that the contour lines of the probability success graph are of the form $\frac 1x$. Additionally, this map shows that the net probability is likely of the form $\log(n*i)$, where $n$ is the number of ships used and $i$ is the number of iterations performed (as in Figure 1).

The coefficients of the logarithmic fits suggest that this is true: the coefficient with respect to ships used is $0.3433$, and the coef. with respect to iterations is $0.3304$. This is a $3.76\%$ difference. The only significant difference lies in the intercept of the functions. However, the growth rate of the functions is the same.

This makes intuitive sense. The total number of searches is equal to $n*i$, and a relatively logarithmic limit is expected. While the distribution must taper off to $1$, and cannot proceed to $\infty$, it is locally logarithmic.

\subsection{Sensitivity of Distance Traveled}



\pagebreak

\begin{thebibliography}{10}
\bibitem{TF} Furukawa, T., Bourgault, F., Lavis, B., Durrant-Whyte F., H., \emph{``Recursive Bayesian Search-and-Tracking Using Coordinated UAVs for Lost Targets"}, IEEE International Conference on Robotics and Automation, 2006. 
\bibitem{LL} L.C.M. Lebreton, S.D. Greer, J.C. Borrero, \emph{``Numerical modeling of floating debris in the world’s oceans"}, Marine Pollution Bulletin, Volume 64, Issue 3, March 2012, Pages 653-661, ISSN 0025-326X, http://dx.doi.org/10.1016/j.marpolbul.2011.10.027.
\bibitem{Mackay98} Mackay, D.J.C, \emph{``Introduction to Monte Carlo Methods"}, submitted for publication.
\bibitem{HR} Henry R. Richardson and Lawrence D. Stone, \emph{``Operations analysis during the underwater search for Scorpion"}, submitted for publication. 
\bibitem{Stone75} Stone, Lawrence D., \textit{Theory of Optimal Search}, New York: Academic Press, 1975.
\bibitem{LS} Lawrence D. Stone, Colleen M. Keller, Thomas M. Kratzke, Johan P. Strumpfer, \emph{``Search for the Wreckage of Air France Flight AF 447"}, Statistical Science 2014, Vol. 29, No. 1, 2014.
\end{thebibliography}

\end{document}